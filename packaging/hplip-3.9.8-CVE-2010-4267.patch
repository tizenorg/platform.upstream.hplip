--- io/hpmud/pml.c.orig	2009-08-04 23:37:25.000000000 +0200
+++ io/hpmud/pml.c	2010-12-17 13:09:28.000000000 +0100
@@ -504,6 +504,8 @@ enum HPMUD_RESULT hpmud_get_pml(HPMUD_DE
       p += 2;                               /* eat type and length */
    }
    
+   if (dLen > buf_size)
+      dLen = buf_size;
    memcpy(buf, p, dLen);
    *bytes_read = dLen; 
    *type = dt;
